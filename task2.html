<!DOCTYPE html>

<head>
    <title>Task 2</title>
</head>

<body>
    <script>
        const recipes = {
            recipes: [],
            addRecipe(name) {
                this.recipes.push({ id: Math.random(), name, products: [] });
            },
            removeRecipe(id) {
                this.recipes = this.recipes.filter((r) => r.id != id);
            },
            addProduct(recipeId, name) {
                const recipe = this.recipes.find((r) => r.id == recipeId);
                recipe.products.push({ id: Math.random(), name });
            },
            removeProduct(id) {
                this.recipes.forEach((recipe) => {
                    recipe.products = recipe.products.filter((p) => p.id != id);
                });
            },
        };

        function render() {
            document.body.innerHTML = `
                <h1>CookAsistant</h1>
                <input placeholder="Recipe Name" />
                <button onclick="recipes.addRecipe(this.previousElementSibling.value)">Add Recipe</button>
                <ul>
                    ${recipes.recipes.map(recipe => `
                        <li>
                            <h2>${recipe.name}</h2>
                            <button onclick="recipes.removeRecipe(${recipe.id})">Remove Recipe</button>
                            <input placeholder="Product Name" />
                            <button onclick="recipes.addProduct(${recipe.id}, this.previousElementSibling.value)">Add Product</button>
                            <ul>
                                ${recipe.products.map(product => `
                                    <li>
                                        <h3>${product.name}</h3>
                                        <button onclick="recipes.removeProduct(${product.id})">Remove Product</button>
                                    </li>`).join("")}
                            </ul>
                        </li>`).join("")}
                </ul>`

            const buttons = document.getElementsByTagName("button");
            [...buttons].forEach(b => { b.addEventListener("click", render) });
        }

        render()
    </script>
</body>

</html>